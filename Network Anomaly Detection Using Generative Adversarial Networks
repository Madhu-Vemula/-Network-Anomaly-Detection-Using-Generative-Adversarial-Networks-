import numpy as np
import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
import logging

# Suppressing the warning
logging.getLogger('tensorflow').setLevel(logging.ERROR)

from google.colab import drive
drive.mount('/content/drive')

# Load and preprocess the dataset
print("Loading and preprocessing the dataset...")
print("Done")
dataset_path = "/content/drive/MyDrive/MINI 1/KDDTrain.csv"

# Load the dataset
df = pd.read_csv(dataset_path, nrows=1000)

# Encode categorical features
print("Encoding categorical features...")
print("Done")
categorical_cols = ['protocol_type', 'service', 'flag', 'label']
for col in categorical_cols:
    df[col] = pd.factorize(df[col])[0]

# Scale numerical features
print("Scaling numerical features...")
print("Done")
scaler = StandardScaler()
numerical_cols = [col for col in df.columns if col not in categorical_cols]
df[numerical_cols] = scaler.fit_transform(df[numerical_cols])

# Split dataset into train and test sets
print("Splitting dataset into train and test sets...")
print("Done")
X_train, X_test = train_test_split(df.values, test_size=0.2, random_state=42)
